{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = '43963855-b23ab28bc2f72f8207f09d24a';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 15;\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchPhotosByQuery = async (query, page = 1) => {\n  const { data } = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: PER_PAGE,\n      page,\n    },\n  });\n  return data;\n};\n","export function createGalleryItemMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n              <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"small-info\">\n               <div class=\"small-info-item\">\n                 <Likes: class=\"info-title\">Likes:</span>\n                 <span class=\"info\">${likes}</span>\n               </div>\n               <div class=\"small-info-item\">\n                 <span class=\"info-title\">Views:</span>\n                 <span class=\"info\"> ${views}</span>\n               </div>\n               <div class=\"small-info-item\">\n                 <span class=\"info-title\">Comments:</span>\n                 <span class=\"info\">${comments}</span>\n               </div>\n               <div class=\"small-info-item\">\n                 <span class=\"info-title\">Downloads:</span>\n                 <span class=\"info\">${downloads}</span>    \n               </div>\n            </div>\n          </li>`;\n      }\n    )\n    .join('');\n}\n","import { fetchPhotosByQuery, PER_PAGE } from './js/pixabay-api';\nimport { createGalleryItemMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchFormEl = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery-list');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreEl = document.querySelector('.btn-load');\nlet query = '';\nlet currentPage = 1;\nlet totalPages = 0;\nlet lightbox;\n\nasync function renderPhotos(searchQuery, page) {\n  try {\n    const imagesData = await fetchPhotosByQuery(searchQuery, page);\n    if (imagesData.hits.length === 0) {\n      iziToast.show({\n        title: 'Error',\n        color: 'red',\n        message: 'Sorry, there was an error fetching images. Please try again!',\n      });\n      loadMoreEl.classList.add('is-hidden');\n    } else {\n      const markup = createGalleryItemMarkup(imagesData.hits);\n      galleryEl.insertAdjacentHTML('beforeend', markup);\n      if (lightbox) {\n        lightbox.refresh();\n      } else {\n        lightbox = new SimpleLightbox('.gallery-list a', {\n          captionsData: 'alt',\n          captionPosition: 'bottom',\n          captionDelay: 250,\n          className: 'my-custom-lightbox',\n        });\n      }\n\n      totalPages = Math.ceil(imagesData.totalHits / PER_PAGE);\n\n      if (totalPages > currentPage) {\n        loadMoreEl.classList.remove('is-hidden');\n      } else {\n        loadMoreEl.classList.add('is-hidden');\n        iziToast.show({\n          title: 'Info',\n          color: 'green',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    }\n  } catch (error) {\n    iziToast.show({\n      title: 'Error',\n      color: 'red',\n      message: 'Sorry, there was an error fetching images. Please try again!',\n    });\n    loadMoreEl.classList.add('is-hidden');\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nconst smoothScrollOnLoadMore = () => {\n  const galleryItems = document.querySelectorAll('.gallery-list li');\n  if (galleryItems.length > 0) {\n    const lastPhotoEl = galleryItems[galleryItems.length - 1];\n    const photoHeight = lastPhotoEl.getBoundingClientRect().height;\n    const paraPhotoHeight = photoHeight * 2;\n    window.scrollBy({\n      top: paraPhotoHeight,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n};\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  const searchQuery = event.target.querySelector('.form-input').value.trim();\n  if (searchQuery === '') {\n    iziToast.show({\n      title: 'Error',\n      color: 'red',\n      message: 'Field is empty. Please write your query!',\n    });\n    return;\n  }\n  galleryEl.innerHTML = '';\n  query = searchQuery;\n  currentPage = 1;\n  loaderEl.classList.remove('is-hidden');\n  loadMoreEl.classList.add('is-hidden');\n  await renderPhotos(query, currentPage);\n  event.target.reset();\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  loaderEl.classList.remove('is-hidden');\n  await renderPhotos(query, currentPage);\n  smoothScrollOnLoadMore();\n}\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreEl.addEventListener('click', onLoadMoreClick);\n"],"names":["API_KEY","BASE_URL","PER_PAGE","axios","fetchPhotosByQuery","query","page","data","createGalleryItemMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchFormEl","galleryEl","loaderEl","loadMoreEl","currentPage","totalPages","lightbox","renderPhotos","searchQuery","imagesData","iziToast","markup","SimpleLightbox","smoothScrollOnLoadMore","galleryItems","paraPhotoHeight","onSearchFormSubmit","event","onLoadMoreClick"],"mappings":"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"}